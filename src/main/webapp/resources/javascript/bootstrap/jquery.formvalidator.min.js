(function($){$.extend({formvalidator:new function(){var u=[];this.defaults={validateOnBlur:false,validateOnSubmit:true,validateHidden:false,validateDisabled:false,enableInlineBinding:true,inlineBindingAttr:'class',onBlurMessageDisplay:'inline',onSubmitMessageDisplay:'summary',inlineMessageHideDelay:3000,cssInlineValidationMessage:'inline-validation-message',cssValidationSummary:'validation-summary',cssValidationSummaryHeader:'validation-summary-header',cssValidationSummaryTitle:'validation-summary-title',cssValidationMessages:'validation-messages',cssValidationMessage:'validation-message',cssValidationFailed:'validation-failed',cssValidationPassed:'validation-passed',debug:false};function log(a){var b=new Date();var h=b.getHours();var m=b.getMinutes();var s=b.getSeconds();m=(m<10)?'0'+m:m;s=(s<10)?'0'+s:s;a='['+h+':'+m+':'+s+'] '+a;if(typeof console!="undefined"&&typeof console.debug!="undefined"){console.log(a)}else{alert(a)}};function getFieldValidators(b){var c=b.closest('form').data('formvalidator');var d=c.config.debug;var e=b.data('validators')||[];if(d){$(e).each(function(j,a){log(' - validator retreived from cache: '+a.id)})}var f=b.data('validators_inlineBound')==true;if(c.config.enableInlineBinding&&!f){var g=detectValidators(b);$(g).each(function(i,a){e.push(a)});b.data('validators',e);b.data('validators_inlineBound',true)}return e};function parseFieldValidatorsFromAttribute(e,f){e=$(e);var g=e.closest('form').data('formvalidator');var h=g.config.debug;var s=e.attr(f);var j=[];if(typeof(s)==='undefined')return j;var k='';var l='';var m=[];var n=[];var o=s.length;var q;var r='class';var t=function(b,c){if(c&&$(c).size()==1){c=c[0]}var d=$.formvalidator.getValidator(b,c);if(d){if(h){log('   - detected "'+d.id+'"');if($.isArray(c)){$(c).each(function(p,a){log('     - initialized with param: "'+a+'"')})}else{log('     - initialized with param: "'+c+'"')}}j.push(d)}}for(var i=0;i<o;i++){var c=s.charAt(i);switch(r){case'class':switch(c){case' ':if(k.length==0)break;t(k,[]);k='';break;case'(':l='';m=[];r='param';break;default:k+=c;break}break;case'param':switch(c){case' ':break;case'\'':case'"':q=c;r='string';break;case'[':r='array';l='';n=[];break;case',':if(l.length>0||$.isArray(l)){m.push(l)}l='';break;case')':if(l.length>0||$.isArray(l)){m.push(l)}l='';t(k,m);k='';r='class';break;default:l+=c;break}break;case'string':switch(c){case'\\':if(i<o-1){l+=s.charAt(++i)}break;case'\'':case'"':if(q==c){r='param'}break;default:l+=c;break}break;case'array':switch(c){case' ':break;case'[':break;case',':if(l.length>0){n.push(l)}l='';break;case']':if(l.length>0){n.push(l);l=n}r='param';break;default:l+=c;break}break}}if(k.length!=0){t(k,m)}return j};function detectValidators(a){a=$(a);var b=a.closest('form').data('formvalidator').config;var c=b.debug;if(c){log(' - binding inline validators...')}var d=parseFieldValidatorsFromAttribute(a,b.inlineBindingAttr);if(c){if(d.length==0){log('   - no validators detected')}}return d};function pass(a,b){var c=a.closest('form').data('formvalidator');a.removeClass(c.config.cssValidationFailed);a.addClass(c.config.cssValidationPassed)};function fail(b,c){var d=b.closest('form').data('formvalidator');b.removeClass(d.config.cssValidationPassed);b.addClass(d.config.cssValidationFailed);$(c).each(function(i,a){d.failedTests.push({message:a.message(b,a.messageParams),field:b})})};function onValidationEnd(g,h){var c=g.config;var j=c.debug;if(j){log('onValidationEnd called on form "'+g.name+'"')}var k=$(g.failedTests);if(k.size()==0){if(j){log('Validation Passed!')}}else{if(j){log('Validation Failed with the following messages:');k.each(function(i,a){log(' - '+a.message)})}var l=(h==='blur')?c.onBlurMessageDisplay:c.onSubmitMessageDisplay;switch(l){case'alert':var m='The following problems were found:\n\n';k.each(function(i,a){m+=a.message+'\n'});alert(m);break;case'inline':k.each(function(i,a){var b=$(a.field);var d=b.position();var e=b.outerWidth(true);var f=$('<div></div>)').text(a.message).addClass(c.cssInlineValidationMessage).css({'position':'absolute','left':(d.left+e+10)+'px','top':d.top+'px','background-color':'#FFF'});$(a.field).after(f);setTimeout(function(){f.slideUp(500)},c.inlineMessageHideDelay)});break;case'summary':$(g).find('.'+c.cssValidationSummary).remove();var n=$('<div class="'+c.cssValidationSummary+'"><div class="'+c.cssValidationSummaryHeader+'"><h2 class="'+c.cssValidationSummaryTitle+'">'+'The following problems were found:'+'</h2></div></div>)');var m=$('<ul class="'+c.cssValidationMessages+'"></ul>');k.each(function(i,a){m.append('<li class="'+c.cssValidationMessage+'">'+a.message+'</li>')});n.append(m);$(g).prepend(n);var o=$(window);var p=n.position();o.scrollTop(p.top);o.scrollLeft(p.left);break;case'none':default:break}g.failedTests=[]}};function bindValidators(g){var c=g.config;if(c.debug){log('Binding validators for form: '+g.name)}var h=$(g).find(':input').not(':button,:submit');if(!c.validateHidden){h=$(h).filter(':visible')}if(!c.validateDisabled){h=$(h).filter(':enabled')}if(c.validateOnBlur){$(h).each(function(i,a){$(a).blur(function(){$(this).trigger('validationStart');$.formvalidator.validateField(this);$(this).trigger('validationEnd');onValidationEnd(g,'blur')})})}if(c.validateOnSubmit){$(g).submit(function(b){$(this).trigger('validationStart');var d=true;var f=$('.'+c.cssInlineValidationMessage);f.hide();try{$(h).each(function(i,a){d=$.formvalidator.validateField(a)&&d});$(this).trigger('validationEnd',[d]);onValidationEnd(g,'submit');if(!d){b.preventDefault()}return d}catch(e){alert(e)}})}};this.construct=function(b){return this.each(function(){var a,config;a=$(this);this.config={};this.inlineBindingPerformed=false;this.failedTests=[];config=$.extend(this.config,$.formvalidator.defaults,b);if(this.config.debug){log('******************************************************');log('*      $.formvalidator Debug Mode Enabled            *');log('******************************************************')}a.data('formvalidator',this);bindValidators(this)})};this.validateField=function(c){var c=$(c);var d=c.closest('form').data('formvalidator');var e=d.config.debug;if(e){log('Validating field: '+c.attr('name'))}var f=getFieldValidators(c);var g=true;var h=[];var i=[];$(f).each(function(j,a){var b=a.test(c,a.params);if(b){if(e){log(' - validator "'+a.id+'" passed.')}h.push(a)}else{if(e){log(' - validator "'+a.id+'" failed.')}i.push(a)}g=g&&b});f='';if(g){if(e){log(' - triggering "validationPassed" event.')}$(c).trigger("validationPassed",[c,h]);pass(c,h)}else{if(e){log(' - triggering "validationFailed" event.')}$(c).trigger("validationFailed",[c,i]);fail(c,i)}return g};this.addValidator=function(a){u[a.id]=a};this.getValidator=function(a,b){var c=u[a];if(!c)return null;if(!b){b=[]}return $.extend(true,{params:b},c)};this.getValidators=function(){return u};this.getLabel=function(a){a=$(a);var b=$('label[for="'+a.attr('name')+'"]:first');if(b.size()==0){return a.attr('name')}var c=$.trim(b.text().replace(/[\:|\*]/g,''));return c}}});$.fn.extend({formvalidator:$.formvalidator.construct});function isString(){if(typeof arguments[0]=='string')return true;if(typeof arguments[0]=='object'){var a=arguments[0].constructor.toString().match(/string/i);return(a!=null)}return false}$.formvalidator.addValidator({id:"alpha",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/^[a-zA-Z]+$/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must only contain letters.'}});$.formvalidator.addValidator({id:"alpha_numeric",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/^[a-zA-Z\d]+$/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must only contain letters and numbers.'}});$.formvalidator.addValidator({id:"between",test:function(a,b){a=$(a);a.data('validators_min_value',parseFloat(b[0]));a.data('validators_max_value',parseFloat(b[1]));return $.formvalidator.getValidator('min').test(a,b[0])&&$.formvalidator.getValidator('max').test(a,b[1])},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be between '+a.data('validators_min_value')+' and '+a.data('validators_max_value')+'.'}});$.formvalidator.addValidator({id:"credit_card",test:function(f,g){f=$(f);var h=g.toLowerCase();var j=function(a,b){if(a=="visa"){var c=/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/}else if(a=="mastercard"){var c=/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/}else if(a=="discover"){var c=/^6011-?\d{4}-?\d{4}-?\d{4}$/}else if(a=="amex"){var c=/^3[4,7]\d{13}$/}else if(a=="diners"){var c=/^3[0,6,8]\d{12}$/}if(!c.test(b))return false;b=b.split("-").join("");var d=0;for(var i=(2-(b.length%2));i<=b.length;i+=2){d+=parseInt(b.charAt(i-1))}for(var i=(b.length%2)+1;i<b.length;i+=2){var e=parseInt(b.charAt(i-1))*2;if(e<10){d+=e}else{d+=(e-9)}}if((d%10)==0)return true;else return false};return $.formvalidator.getValidator('empty').test(f)||j(h,f.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid credit card number.'}});$.formvalidator.addValidator({id:"date",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/^(((0[13578]|1[02])[- \/\.](0[1-9]|[12]\d|3[01])[- \/\.]((1[6-9]|[2-9]\d)\d{2}))|((0[13456789]|1[012])[- \/\.](0[1-9]|[12]\d|30)[- \/\.]((1[6-9]|[2-9]\d)\d{2}))|(02[- \/\.](0[1-9]|1\d|2[0-8])[- \/\.]((1[6-9]|[2-9]\d)\d{2}))|(02[- \/\.]29[- \/\.]((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))))$/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid date in the following format: "mm-dd-yyyy".'}});$.formvalidator.addValidator({id:"email",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/\w{1,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid email address, like "username@domain.com".'}});$.formvalidator.addValidator({id:"empty",test:function(a){if(a==null)return true;a=$(a).get(0);switch(a.type){case'checkbox':return $(':checkbox[name="'+a.name+'"]:checked').size()==0;case'radio':return $(':radio[name="'+a.name+'"]:checked').size()==0;case'select-many':return $(a).find('option:selected').size()==0;case'text':case'password':case'select-one':case'textarea':case'hidden':default:return $(a).val().length==0}},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be empty.'}});$.formvalidator.addValidator({id:"equals",test:function(a,b){a=$(a);a.data('validators_equals',b);return $.formvalidator.getValidator('empty').test(a)||a.val()==b},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be "'+a.data('validators_equals')+'".'}});$.formvalidator.addValidator({id:"float",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||($.formvalidator.getValidator('number').test(a)&&!isNaN(parseFloat(a.val())))},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a number.'}});$.formvalidator.addValidator({id:"integer",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/(^-?\d\d*$)/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be an integer.'}});$.formvalidator.addValidator({id:"ip_address",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/^\d{2,3}[\.]\d{1,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid ip address, like "127.0.0.1".'}});$.formvalidator.addValidator({id:"iso_date",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/^((((19|20)(([02468][048])|([13579][26]))-02-29))|((20[0-9][0-9])|(19[0-9][0-9]))-((((0[1-9])|(1[0-2]))-((0[1-9])|(1\d)|(2[0-8])))|((((0[13578])|(1[02]))-31)|(((0[1,3-9])|(1[0-2]))-(29|30)))))$/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid date in the following format: "yyyy-mm-dd".'}});$.formvalidator.addValidator({id:"length_between",test:function(a,b){a=$(a);minLength=parseInt(b[0]);maxLength=parseInt(b[1]);a.data('validators_min_length',minLength);a.data('validators_max_length',maxLength);return $.formvalidator.getValidator('min_length').test(a,minLength)&&$.formvalidator.getValidator('max_length').test(a,maxLength)},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be between '+a.data('validators_min_length')+' and '+a.data('validators_max_length')+' characters long.'}});$.formvalidator.addValidator({id:"length_equals",test:function(a,b){a=$(a);a.data('validators_length_equals',b);return $.formvalidator.getValidator('empty').test(a)||a.val().length==b},message:function(a){var b=a.data('validators_length_equals');if(b==1){return'"'+$.formvalidator.getLabel(a)+'" must be one character long.'}else{return'"'+$.formvalidator.getLabel(a)+'" must be '+b+' characters long.'}}});$.formvalidator.addValidator({id:"match",test:function(a,b){a=$(a);b=$(a.closest('form').find(b));if(b){b.unbind('change.validators_match');b.bind('change.validators_match',function(){$.formvalidator.validateField(a)})}a.data('validators_match',b);return a.val()===b.val()},message:function(a){var b=a.data('validators_match');return'"'+$.formvalidator.getLabel(a)+'" must match "'+$.formvalidator.getLabel(b)+'".'}});$.formvalidator.addValidator({id:"max",test:function(a,b){a=$(a);b=parseFloat(b);a.data('validators_max_value',b);return $.formvalidator.getValidator('empty').test(a)||parseFloat(a.val())<=b},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" cannot be more than '+a.data('validators_max_value')+'.'}});$.formvalidator.addValidator({id:"max_length",test:function(a,b){a=$(a);b=parseInt(b);a.data('validators_max_length',b);return $.formvalidator.getValidator('empty').test(a)||a.val().length<=b},message:function(a){var b=a.data('validators_max_length');if(b==1){return'"'+$.formvalidator.getLabel(a)+'" cannot be more than one character long.'}else{return'"'+$.formvalidator.getLabel(a)+'" cannot be more than '+b+' characters long.'}}});$.formvalidator.addValidator({id:"min",test:function(a,b){a=$(a);b=parseFloat(b);a.data('validators_min_value',b);return $.formvalidator.getValidator('empty').test(a)||parseFloat(a.val())>=b},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be at least '+a.data('validators_min_value')+'.'}});$.formvalidator.addValidator({id:"min_length",test:function(a,b){a=$(a);b=parseInt(b);a.data('validators_min_length',b);return $.formvalidator.getValidator('empty').test(a)||a.val().length>=b},message:function(a){var b=a.data('validators_min_length');if(b==1){return'"'+$.formvalidator.getLabel(a)+'" must be at least one character long.'}else{return'"'+$.formvalidator.getLabel(a)+'" must be at least '+b+' characters long.'}}});$.formvalidator.addValidator({id:"number",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||(!isNaN(a.val())&&!/^\s+$/.test(a.val()))},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a number.'}});$.formvalidator.addValidator({id:"phone",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/^(1\s*[-\/\.]?)?(\((\d{3})\)|(\d{3}))\s*[-\/\.]?\s*(\d{3})\s*[-\/\.]?\s*(\d{4})\s*(([xX]|[eE][xX][tT])\.?\s*(\d+))*$/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid telephone number.'}});$.formvalidator.addValidator({id:"required",test:function(a){return!$.formvalidator.getValidator('empty').test(a)},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" is required.'}});$.formvalidator.addValidator({id:"ssn",test:function(d){d=$(d);var e=function(a){var b=/^([0-6]\d{2}|7[0-6]\d|77[0-2])([ \-]?)(\d{2})\2(\d{4})$/;if(!b.test(a)){return false}var c=a;if(a.indexOf("-")!=-1){c=(a.split("-")).join("")}if(a.indexOf(" ")!=-1){c=(a.split(" ")).join("")}if(c.substring(0,3)=="000"){return false}if(c.substring(3,5)=="00"){return false}if(c.substring(5,9)=="0000"){return false}return true};return $.formvalidator.getValidator('empty').test(d)||(e(d.val()))},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid social security number of the format: ###-##-####.'}});$.formvalidator.addValidator({id:"regex",test:function(a,b){var c;var d;if($.isArray(b)){c=new RegExp(b[0]);a.data('validators_regex',b[1])}else{c=new RegExp(b)}return $.formvalidator.getValidator('empty').test(a)||c.test(a.val())},message:function(a){if(a.data('validators_regex')){return'"'+$.formvalidator.getLabel(a)+'" '+a.data('validators_regex')}else{return'A problem was found with "'+$.formvalidator.getLabel(a)+'"'}}});$.formvalidator.addValidator({id:"starts_with",test:function(a,b){var c;if(b&&isString(b)){c=new RegExp('^'+b);a.data('validators_starts_with',b)}return $.formvalidator.getValidator('empty').test(a)||c.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must start with "'+a.data('validators_starts_with')+'".'}});$.formvalidator.addValidator({id:"starts_with_alpha",test:function(a){return $.formvalidator.getValidator('empty').test(a)||/^[a-zA-Z]/.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must start with a letter.'}});$.formvalidator.addValidator({id:"url",test:function(a){a=$(a);return $.formvalidator.getValidator('empty').test(a)||/^(http|https|ftp|file):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i.test(a.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid URL, like "http://www.domain.com"'}});$.formvalidator.addValidator({id:"valid_entries",test:function(a,b){a=$(a);a.data('validators_valid_entries',b);return $.formvalidator.getValidator('empty').test(a)||$.inArray(a.val(),b)!=-1},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be one of the following: '+a.data('validators_valid_entries')+'.'}});$.formvalidator.addValidator({id:"zip_code",test:function(b,c){b=$(b);var e='usa';if(c&&isString(c)){e=c.toLowerCase()}var f;switch(e){case'canada':f=function(a){return/^[abceghjklmnprstvxyABCEGHJKLMNPRSTVXY][0-9][abceghjklmnprstvwxyzABCEGHJKLMNPRSTVWXYZ][]?[0-9][abceghjklmnprstvwxyzABCEGHJKLMNPRSTVWXYZ][0-9]$/.test(a)};break;case'usa':default:f=function(a){return/^(?!0{5})(\d{5})(?!-?0{4})(-?\d{4})?$/.test(a)}}return $.formvalidator.getValidator('empty').test(b)||f(b.val())},message:function(a){return'"'+$.formvalidator.getLabel(a)+'" must be a valid zip code.'}})})($);